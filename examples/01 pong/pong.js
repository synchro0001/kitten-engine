(()=>{"use strict";class e{withFields(e){let n=Object.keys(this).map((n=>n in e?e[n]:this[n]));return new this.constructor(...n)}}class n{static fromArray(e,n){let t=n||new a;for(let n=e.length-1;n>=0;--n)t=new c(e[n],t);return t}[Symbol.iterator](){return new s(this)}toArray(){return[...this]}atLeastLength(e){for(let n of this){if(e<=0)return!0;e--}return e<=0}hasLength(e){for(let n of this){if(e<=0)return!1;e--}return 0===e}countLength(){let e=0;for(let n of this)e++;return e}}function t(e,t){return n.fromArray(e,t)}class s{#e;constructor(e){this.#e=e}next(){if(this.#e instanceof a)return{done:!0};{let{head:e,tail:n}=this.#e;return this.#e=n,{value:e,done:!1}}}}class a extends n{}class c extends n{constructor(e,n){super(),this.head=e,this.tail=n}}function o(e,n){return 0===n?0:e/n}function i(e){return e.toString(16).toUpperCase()}function l(e,n){let t=d(n),s=(a=e,c=t,Math.trunc(o(a,c)));var a,c;let i=function(e,n){return 0===n?0:e%n}(e,t);return function(e,n,t){for(;;){let s=e;if(n<=0)return t;e=s,n-=1,t+=s}}(n,s,"")+function(e,n,t){if(t<0)return"";if(n<0){let s=d(e)+n;return s<0?"":x(e,s,t)}return x(e,n,t)}(n,0,i)}function r(e,n,t){let s=n-d(e);return s<=0?e:l(s,t)+e}function d(e){if(""===e)return 0;const n=u(e);if(n){let e=0;for(const t of n)e++;return e}return e.match(/./gsu).length}let f;function u(e){if(globalThis.Intl&&Intl.Segmenter)return f||=new Intl.Segmenter,f.segment(e)[Symbol.iterator]()}function x(e,n,t){if(t<=0||n>=e.length)return"";const s=u(e);if(s){for(;n-- >0;)s.next();let e="";for(;t-- >0;){const n=s.next().value;if(void 0===n)break;e+=n.segment}return e}return e.match(/./gsu).slice(n,n+t).join("")}new WeakMap,new DataView(new ArrayBuffer(8)),Math.pow(2,5),Symbol();const h=[" ","\t","\n","\v","\f","\r","Â…","\u2028","\u2029"].join("");function w(e){return Math.round(e)}function y(e,n,t){var s,a;return function(e,n){return e>n?e:n}((s=e)<(a=t)?s:a,n)}function m(e){return e}new RegExp(`^[${h}]*`),new RegExp(`[${h}]*$`);let g,p,b,v,A={},M={},K={x:0,y:0};function E(){const e=document.getElementById(g),n=e.getContext("2d");return n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,e.width,e.height),n.setTransform(1,0,0,-1,e.width/2,e.height/2),n.scale(v,v),n}function L(){const e=document.getElementById(g);p/b>=window.innerWidth/window.innerHeight?(e.width=window.innerWidth,v=window.innerWidth/p,e.height=b*v,e.style.top=(window.innerHeight-e.height)/2+"px",e.style.left="0px"):(e.height=window.innerHeight,v=window.innerHeight/b,e.width=p*v,e.style.top="0px",e.style.left=(window.innerWidth-e.width)/2+"px"),e.getContext("2d").imageSmoothingEnabled=!1}let S,N=[],D={},F=0;function _(e,n,t,s,a){function c(e,s){const a=e-F;if(a>16.6){S=a,t(s);const o=n(s);F=e,function(){for(const e in A)A[e]&=1;for(const e in M)M[e]&=1}(),requestAnimationFrame((e=>c(e,o)))}else requestAnimationFrame((e=>c(e,s)))}const o=document.getElementById(g);o.getContext("2d").imageSmoothingEnabled=!1,o.style.display="block",window.addEventListener("keydown",(e=>{A[e.code]=3})),window.addEventListener("keyup",(e=>{A[e.code]=4})),window.addEventListener("mousedown",(e=>{M[e.button]=3,K.x=e.clientX,K.y=e.clientY})),window.addEventListener("touchstart",(e=>{M[0]=3,K.x=e.touches[0].clientX,K.y=e.touches[0].clientY})),window.addEventListener("mouseup",(e=>{M[e.button]=4})),window.addEventListener("touchend",(e=>{M[0]=4})),window.addEventListener("mousemove",(e=>{K.x=e.clientX,K.y=e.clientY})),window.addEventListener("touchmove",(function(e){K.x=e.touches[0].clientX,K.y=e.touches[0].clientY}));const i=s.toArray().map(((e,n)=>new Promise((t=>{const s=new Image;s.onload=()=>{N[n]=s,t()},s.onerror=()=>{console.error(`Failed to load image ${n}`)},s.src=e})))),l=a.toArray().map((async(e,n)=>{if(e.endsWith(".js"))try{await async function(e,n){const t=await fetch(e),s=await t.text(),a=JSON.parse(s.replace(/\[,/g,"[null,").replace(/,,\]/g,",null]").replace(/,\s*(?=[,\]])/g,",null").replace(/([\[,]-?)(?=\.)/g,"$10").replace(/-\./g,"-0."),((e,n)=>null===n?void 0:n)),c=I(...a);D[n]=c,R[n]=1}(e,n)}catch(t){await async function(e,n){const t=await fetch(e),s=await t.text(),a=JSON.parse(s.replace(/\[,/g,"[null,").replace(/,,\]/g,",null]").replace(/,\s*(?=[,\]])/g,",null").replace(/([\[,]-?)(?=\.)/g,"$10").replace(/-\./g,"-0."),((e,n)=>null===n?void 0:n)),c=k(...a);D[n]=c,R[n]=0}(e,n)}else await async function(e,n){const t=await fetch(e),s=await t.arrayBuffer();D[n]=await B.decodeAudioData(s),R[n]=2}(e,n)}));Promise.all([Promise.all(i),Promise.all(l)]).then((()=>{const n=e();requestAnimationFrame((e=>c(e,n)))})).catch((e=>{console.error("Failed to start engine:",e)}))}const k=(e=1,n=.05,t=220,s=0,a=0,c=.1,o=0,i=1,l=0,r=0,d=0,f=0,u=0,x=0,h=0,w=0,y=0,m=1,g=0,p=0)=>{let b,v,A=2*Math.PI,M=l*=500*A/C**2,K=(0<h?1:-1)*A/4,E=t*=(1+2*n*Math.random()-n)*A/C,L=[],S=0,N=0,D=0,F=1,_=0,k=0,B=0;for(r*=500*A/C**3,h*=A/C,d*=A/C,f*=C,u=C*u|0,v=(s=99+C*s)+(g*=C)+(a*=C)+(c*=C)+(y*=C)|0;D<v;L[D++]=B)++k%(100*w|0)||(B=o?1<o?2<o?3<o?Math.sin((S%A)**3):Math.max(Math.min(Math.tan(S),1),-1):1-(2*S/A%2+2)%2:1-4*Math.abs(Math.round(S/A)-S/A):Math.sin(S),B=(u?1-p+p*Math.sin(2*Math.PI*D/u):1)*(0<B?1:-1)*Math.abs(B)**i*e*P*(D<s?D/s:D<s+g?1-(D-s)/g*(1-m):D<s+g+a?m:D<v-y?(v-D-y)/c*m:0),B=y?B/2+(y>D?0:(D<v-y?1:(v-D)/y)*L[D-y|0]/2):B),b=(t+=l+=r)*Math.sin(N*h-K),S+=b-b*x*(1-1e9*(Math.sin(D)+1)%2),N+=b-b*x*(1-1e9*(Math.sin(D)**2+1)%2),F&&++F>f&&(t+=d,E+=d,F=0),!u||++_%u||(t=E,l=M,F=F||1);return L},P=.3,C=44100,B=new(window.AudioContext||webkitAudioContext),I=(e,n,t,s=125)=>{let a,c,o,i,l,r,d,f,u,x,h,w,y,m,g,p=0,b=[],v=[],A=[],M=0,K=0,E=1,L={},S=C/s*60>>2;for(;E;M++)b=[E=f=h=y=0],t.map(((s,h)=>{for(d=n[s][M]||[0,0,0],E|=!!n[s][M],g=y+(n[s][0].length-2-!f)*S,m=h==t.length-1,c=2,i=y;c<d.length+m;f=++c){for(l=d[c],u=c==d.length+m-1&&m||x!=(d[0]||0)|l,o=0;o<S&&f;o++>S-99&&u?w+=(w<1)/99:0)r=(1-w)*b[p++]/2||0,v[i]=(v[i]||0)-r*K+r,A[i]=(A[i++]||0)+r*K+r;l&&(w=l%1,K=d[1]||0,(l|=0)&&(b=L[[x=d[p=0]||0,l]]=L[[x,l]]||(a=[...e[x]],a[2]*=2**((l-12)/12),l>0?k(...a):[])))}y=g}));return[v,A]};let R=[];class $ extends e{constructor(e,n,t,s){super(),this.r=e,this.g=n,this.b=t,this.a=s}}function T(e){return function(e){return"#"+r(i(e.r),2,"0")+r(i(e.g),2,"0")+r(i(e.b),2,"0")}(e)+r(i((n=255*e.a)>=0?w(n):0-w(function(e){return-1*e}(n))),2,"0");var n}const W=new $(226,226,226,1),H=new $(240,96,72,1),Y=new $(24,28,37,1);class q extends e{constructor(e,n){super(),this.x=e,this.y=n}}function O(e,n){return new q(e.x*n.x,e.y*n.y)}function U(e,n){return new q(e.x*n,e.y*n)}function V(e){return e}function X(e,n,t,s){return function(e,n,t,s,a,c){const o=n-s/2,i=t-a/2;return e.fillStyle=c,e.fillRect(o,i,s,a),e}(e,n.x,n.y,t.x,t.y,T(s))}function j(e,n,t,s,a,c,o,i){return function(e,n,t,s,a,c,o,i,l){return e.fillStyle=l,e.textAlign="center",e.font=`${c} ${a}px ${o}`,e.save(),e.scale(1,-1),e.translate(t,-s),e.rotate(i),e.fillText(n,0,-0),e.restore(),e}(e,n,t.x,t.y,s,a,c,o,T(i))}class J extends e{}class G extends e{}class Q extends e{}class z extends e{}class Z extends e{}class ee extends e{}class ne extends e{}class te extends e{}class se extends e{}class ae extends e{}class ce extends e{}class oe extends e{}class ie extends e{}class le extends e{}class re extends e{}class de extends e{}class fe extends e{}class ue extends e{}class xe extends e{}class he extends e{}class we extends e{}class ye extends e{}class me extends e{}class ge extends e{}class pe extends e{}class be extends e{}class ve extends e{}class Ae extends e{}class Me extends e{}class Ke extends e{}class Ee extends e{}class Le extends e{}class Se extends e{}class Ne extends e{}class De extends e{}class Fe extends e{}class _e extends e{}class ke extends e{}class Pe extends e{}class Ce extends e{}class Be extends e{}class Ie extends e{}class Re extends e{}class $e extends e{}class Te extends e{}class We extends e{}class He extends e{}class Ye extends e{}class qe extends e{}class Oe extends e{}class Ue extends e{}class Ve extends e{}class Xe extends e{}class je extends e{}class Je extends e{}class Ge extends e{}class Qe extends e{}class ze extends e{}class Ze extends e{}class en extends e{}class nn extends e{}class tn extends e{}class sn extends e{}class an extends e{}class cn extends e{}class on extends e{}class ln extends e{}class rn extends e{}class dn extends e{}class fn extends e{}class un extends e{}class xn extends e{}class hn extends e{}class wn extends e{}class yn extends e{}class mn extends e{}class gn extends e{}class pn extends e{}class bn extends e{}class vn extends e{}class An extends e{}class Mn extends e{}class Kn extends e{}class En extends e{}class Ln extends e{}class Sn extends e{}class Nn extends e{}class Dn extends e{}class Fn extends e{}class _n extends e{}class kn extends e{}class Pn extends e{}class Cn extends e{}class Bn extends e{}class In extends e{}class Rn extends e{}class $n extends e{}class Tn extends e{}class Wn extends e{}class Hn extends e{}class Yn extends e{}class qn extends e{}class On extends e{}class Un extends e{}class Vn extends e{}class Xn extends e{}class jn extends e{}class Jn extends e{}class Gn extends e{}function Qn(e){return e instanceof J?function(){for(const e in A)if(1&A[e])return!0;return!1}():function(e){return!!(1&A[e])}((n=e)instanceof J?"":n instanceof G?"KeyA":n instanceof Q?"KeyB":n instanceof z?"KeyC":n instanceof Z?"KeyD":n instanceof ee?"KeyE":n instanceof ne?"KeyF":n instanceof te?"KeyG":n instanceof se?"KeyH":n instanceof ae?"KeyI":n instanceof ce?"KeyJ":n instanceof oe?"KeyK":n instanceof ie?"KeyL":n instanceof le?"KeyM":n instanceof re?"KeyN":n instanceof de?"KeyO":n instanceof fe?"KeyP":n instanceof ue?"KeyQ":n instanceof xe?"KeyR":n instanceof he?"KeyS":n instanceof we?"KeyT":n instanceof ye?"KeyU":n instanceof me?"KeyV":n instanceof ge?"KeyW":n instanceof pe?"KeyX":n instanceof be?"KeyY":n instanceof ve?"KeyZ":n instanceof Ae?"Space":n instanceof Ke?"ArrowUp":n instanceof Le?"ArrowDown":n instanceof Me?"ArrowLeft":n instanceof Ee?"ArrowRight":n instanceof Se?"Backspace":n instanceof Ne?"Tab":n instanceof De?"Enter":n instanceof Fe?"ShiftLeft":n instanceof _e?"ShiftRight":n instanceof ke?"ControlLeft":n instanceof Pe?"ControlRight":n instanceof Ce?"AltLeft":n instanceof Be?"AltRight":n instanceof Ie?"Pause":n instanceof Re?"CapsLock":n instanceof $e?"Escape":n instanceof Te?"PageUp":n instanceof We?"PageDown":n instanceof He?"End":n instanceof Ye?"Home":n instanceof qe?"PrintScreen":n instanceof Oe?"Insert":n instanceof Ue?"Delete":n instanceof Ve?"Digit0":n instanceof Xe?"Digit1":n instanceof je?"Digit2":n instanceof Je?"Digit3":n instanceof Ge?"Digit4":n instanceof Qe?"Digit5":n instanceof ze?"Digit6":n instanceof Ze?"Digit7":n instanceof en?"Digit8":n instanceof nn?"Digit9":n instanceof tn?"MetaLeft":n instanceof sn?"MetaRight":n instanceof an?"ContextMenu":n instanceof cn?"Numpad0":n instanceof on?"Numpad1":n instanceof ln?"Numpad2":n instanceof rn?"Numpad3":n instanceof dn?"Numpad4":n instanceof fn?"Numpad5":n instanceof un?"Numpad6":n instanceof xn?"Numpad7":n instanceof hn?"Numpad8":n instanceof wn?"Numpad9":n instanceof yn?"NumpadMultiply":n instanceof mn?"NumpadAdd":n instanceof gn?"NumpadSubtract":n instanceof pn?"NumpadDecimal":n instanceof bn?"NumpadDivide":n instanceof vn?"F1":n instanceof An?"F2":n instanceof Mn?"F3":n instanceof Kn?"F4":n instanceof En?"F5":n instanceof Ln?"F6":n instanceof Sn?"F7":n instanceof Nn?"F8":n instanceof Dn?"F9":n instanceof Fn?"F10":n instanceof _n?"F11":n instanceof kn?"F12":n instanceof Pn?"NumLock":n instanceof Cn?"ScrollLock":n instanceof Bn?"AudioVolumeMute":n instanceof In?"AudioVolumeDown":n instanceof Rn?"AudioVolumeUp":n instanceof $n?"LaunchMediaPlayer":n instanceof Tn?"LaunchApplication1":n instanceof Wn?"LaunchApplication2":n instanceof Hn?"Semicolon":n instanceof Yn?"Equal":n instanceof qn?"Comma":n instanceof On?"Minus":n instanceof Un?"Period":n instanceof Vn?"Slash":n instanceof Xn?"Backquote":n instanceof jn?"BracketLeft":n instanceof Jn?"Backslash":n instanceof Gn?"BracketRight":"Quote");var n}class zn extends e{}class Zn extends e{}function et(e){return e instanceof zn?0:e instanceof Zn?1:2}function nt(e){return function(e){return!!(1&M[e])}(et(e))}function tt(){let e=function(){const e=document.getElementById(g),n=e.getBoundingClientRect(),t=n.left,s=n.top,a=e.getContext("2d").getTransform().invertSelf(),c=K.x-t,o=K.y-s;return[a.a*c+a.c*o+a.e,a.b*c+a.d*o+a.f]}();return new q((n=e)[0],n[1]);var n}function st(e,n){return t=U(n,60*S/1e3),s=e,new q(t.x+s.x,t.y+s.y);var t,s}class at extends e{constructor(e,n,t,s,a){super(),this.ball_pos=e,this.ball_vel=n,this.player_y=t,this.has_lost=s,this.score=a}}function ct(){return new at(new q(0,0),new q(2,.8),0,!1,0)}!function(e,n,t,s,a,c,o,i){(function(e,n,t,s,a,c,o,i){document.body.style.margin="0",document.body.style.padding="0",document.body.style.overflow="hidden",document.documentElement.style.margin="0",document.documentElement.style.padding="0",document.documentElement.style.overflow="hidden",document.getElementById(s).style.position="absolute",g=s,p=a,b=c,L(),window.addEventListener("resize",(()=>L())),_(e,n,t,o,i)})(e,n,t,s,a,c,o,i)}(ct,(function(e){let n=(()=>{let n=e.player_y,t=(Qn(new G)||nt(new zn)&&tt().x<0?e=>e+5:m)(n);return(Qn(new he)||nt(new zn)&&tt().x>0?e=>e-5:m)(t)})(),t=st(e.ball_pos,e.ball_vel),s=t,a=t.x,c=t.y,i=a<-250+o(10,2)+8&&c<e.player_y+o(50,2)&&c>e.player_y-o(50,2)&&e.ball_vel.x<0,l=i&&!e.has_lost?e.score+1:e.score,r=(()=>{let n=(s=U(e.ball_vel,1.01),l=new q(-5,-2),r=new q(5,2),new q(y(s.x,l.x,r.x),y(s.y,l.y,r.y))),t=(i||a>250-o(10,2)-8?e=>O(new q(-1,1),e):V)(n);var s,l,r;return(c<-300||c>300?e=>O(new q(1,-1),e):V)(t)})();return e.has_lost&&(Qn(new Ae)||function(e){return!!(2&M[e])}(et(new zn)))?ct():new at(s,r,n,a<-265||e.has_lost,l)}),(function(e){let n=(()=>{if(e.has_lost){let e=j(E(),"You lost",new q(0,0),100,300,"Arial",0,H),n=j(e,"Press space or anywhere",new q(0,-70),70,200,"Arial",0,H);return j(n,"on the screen to continue",new q(0,-130),70,200,"Arial",0,H)}{let n=X(E(),new q(-250,e.player_y),new q(10,50),W);return function(e,n,t,s){return function(e,n,t,s,a){return e.fillStyle=a,e.beginPath(),e.arc(n,t,s,0,2*Math.PI),e.fill(),e}(e,n.x,n.y,t,T(s))}(X(n,new q(250,e.ball_pos.y),new q(10,50),W),e.ball_pos,8,W)}})(),t=X(j(function(e,n){return e.canvas.style.backgroundColor=n,p&&(document.body.style.backgroundColor=n),e}(n,T(Y)),"Score: "+e.score.toString(),new q(0,-380),70,200,"Arial",0,W),new q(0,-313),new q(500,10),W);j(X(t,new q(0,313),new q(500,10),W),"PONG",new q(0,350),100,300,"Arial",0,W)}),"canvas",1920,1080,t([]),t([]))})();